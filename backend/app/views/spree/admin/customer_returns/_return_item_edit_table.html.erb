<table class="index return-items-table">
  <thead>
    <tr>
      <th><%= Spree.t(:product) %></th>
      <th><%= Spree.t(:charged) %></th>
      <th><%= Spree.t(:pre_tax_refund_amount) %></th>
      <th><%= Spree.t(:preferred_reimbursement_type) %></th>
      <th><%= Spree.t(:reimbursement_type_override) %></th>
      <th><%= Spree.t(:acceptance_status) %></th>
    </tr>
  </thead>
  <tbody>
    <%= f.fields_for :return_items, return_items do |item_fields| %>
      <% return_item = item_fields.object %>

      <tr>
        <td>
          <div class="variant-name"><%= return_item.inventory_unit.variant.name %></div>
          <div class="variant-options"><%= return_item.inventory_unit.variant.options_text %></div>
        </td>
        <td class="align-center">
          <%= return_item.display_pre_tax_amount %>
        </td>
        <td class="align-center">
          <% if return_item.reimbursement %>
            <%= return_item.display_pre_tax_amount %>
          <% else %>
            <%= item_fields.text_field :pre_tax_amount, { class: 'refund-amount-input' } %>
          <% end %>
        </td>
        <td class="align-center">
          <%= reimbursement_type_name(return_item.preferred_reimbursement_type) %>
        </td>
        <td class='align-center'>
          <%= item_fields.select(
            :override_reimbursement_type_id,
            reimbursement_types.collect { |r| [r.name.humanize, r.id] },
            {include_blank: true},
            {class: 'select2 fullwidth', "data-placeholder" => Spree.t(:none_selected)}
          ) %>
        </td>
        <td>
          <%= item_fields.select(
            :acceptance_status,
            (%w(accepted rejected) + [return_item.acceptance_status]).uniq.map { |s| [s.humanize, s] },
            {},
            {class: 'select2 fullwidth'}
          ) %>
        </td>
      </tr>

    <% end %>
  </tbody>
</table>
